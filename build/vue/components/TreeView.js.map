{"version":3,"sources":["../../../src/vue/components/TreeView.js"],"names":["object","RootNode","defaults","TreeViewNode","combine","withLabels","withListener","TreeViewBase","name","props","data","searchInput","filtered","methods","onSearch","evt","input","currentTarget","value","$data","rootNode","filterTree","computed","computedModel","$props","sort","model","wrapDragNDrop","created","_props","get","filter","prop","_outputs","onSelect","onDrag","dragndrop","drag","onOver","over","onEnter","enter","onLeave","leave","onDrop","drop","onCancel","cancel","_state","set","key","s","$forceUpdate","mounted","keyUpListener","subscribe","onKey","keyDownListener","render","rest","filteredModel","ancestors","folded","searched","trim","searchBar","search","labels","mixCss","TreeView","eventType","autoMount"],"mappings":"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","file":"TreeView.js","sourcesContent":["import { object } from \"@bosket/tools\"\nimport { RootNode, defaults } from \"@bosket/core\"\nimport { TreeViewNode } from \"./TreeViewNode\"\nimport { combine, withLabels, withListener } from \"../traits\"\n\nconst TreeViewBase = {\n    name: \"TreeView\",\n    props: [ \"model\", \"category\", \"selection\", \"onSelect\", \"display\", \"search\", \"transition\",\n        \"strategies\", \"labels\", \"css\", \"dragndrop\", \"sort\", \"disabled\", \"openerOpts\", \"async\",\n        \"keyUpListener\", \"keyDownListener\", \"unique\" ],\n    data: () => ({\n        searchInput: \"\",\n        filtered: null\n    }),\n    methods: {\n        onSearch(evt) {\n            const input = evt.currentTarget.value\n            this.$data.searchInput = input\n            this.$data.filtered = this.rootNode.filterTree(input)\n        }\n    },\n    computed: {\n        computedModel() {\n            return this.$props.sort ?\n                this.$props.model.sort(this.$props.sort) :\n                this.$props.model\n        },\n        wrapDragNDrop() { return this.rootNode.wrapDragNDrop() }\n    },\n    created() {\n        const _props = {\n            get: () => ({\n                ...defaults,\n                ...object(this.$props).filter(prop => !!prop)\n            })\n        }\n        const _outputs = {\n            onSelect:   this.$props.onSelect,\n            onDrag:     this.$props.dragndrop && this.$props.dragndrop.drag,\n            onOver:     this.$props.dragndrop && this.$props.dragndrop.over,\n            onEnter:    this.$props.dragndrop && this.$props.dragndrop.enter,\n            onLeave:    this.$props.dragndrop && this.$props.dragndrop.leave,\n            onDrop:     this.$props.dragndrop && this.$props.dragndrop.drop,\n            onCancel:   this.$props.dragndrop && this.$props.dragndrop.cancel\n        }\n        const _state = {\n            get: () => ({ ...this.$data }),\n            set: s => {\n                for(const key in s) {\n                    if(key in this.$data) this.$data[key] = s[key]\n                }\n            }\n        }\n        this.rootNode = new RootNode(\n            _props,\n            _outputs,\n            _state,\n            this.$forceUpdate\n        )\n    },\n    mounted() {\n        this.keyUpListener.subscribe(this.rootNode.onKey)\n        this.keyDownListener.subscribe(this.rootNode.onKey)\n    },\n    render() {\n        const { onSelect, sort, model, ...rest } = object(this.$props).filter(prop => !!prop)\n        const data = {\n            props: {\n                ...defaults,\n                ...rest,\n                model: this.computedModel,\n                filteredModel: this.$data.filtered,\n                onSelect: this.rootNode.onSelect,\n                dragndrop: this.wrapDragNDrop,\n                ancestors: [],\n                sort: sort,\n                folded: false,\n                searched: !!this.$data.searchInput.trim()\n            }\n        }\n\n        const searchBar = !this.$props.search ? null :\n            <input\n                type=\"search\"\n                class={ this.rootNode.mixCss(\"search\") }\n                value={ this.$data.searchInput }\n                placeholder={ this.$props.labels && this.$props.labels[\"search.placeholder\"] }\n                onInput={ this.onSearch } />\n\n        return (\n            <div class={ this.rootNode.mixCss(\"TreeView\") }>\n                { searchBar }\n                <TreeViewNode { ...data } />\n            </div>\n        )\n    }\n}\n\nexport const TreeView = combine(\n    withLabels(defaults.labels),\n    withListener({ eventType: \"keyup\", prop: \"keyUpListener\", autoMount: true }),\n    withListener({ eventType: \"keydown\", prop: \"keyDownListener\", autoMount: true })\n)(TreeViewBase)\n"]}